

## 8. 実装に関する考慮事項とトレードオフ

### 8.1. 通知の信頼性について

今回の実装では、クライアントサイドのService Worker内で`setTimeout`を利用して通知をスケジュールしています。この方法は、サーバーを必要とせず、手軽に実装できるというメリットがあります。

しかし、このアプローチには以下の信頼性の限界が存在します。

- **ブラウザの省電力機能**: 長時間非アクティブな場合や、デバイスがスリープしている場合、ブラウザはService Workerの動作を一時停止させることがあります。これにより、`setTimeout`のタイマーが遅延したり、実行されない可能性があります。
- **ブラウザの再起動**: ブラウザを完全に終了・再起動すると、スケジュールされていた`setTimeout`は失われます。

### 8.2. より堅牢な代替案

より高い信頼性で通知を配信するためには、以下のWeb技術の利用が推奨されます。

1.  **Web Push API**: サーバーサイドからプッシュメッセージを送信する方法です。ブラウザが閉じていても、OSレベルでメッセージを受信できるため、最も確実な通知手段です。ただし、別途アプリケーションサーバーとVAPIDキーの管理が必要になります。

2.  **Periodic Background Sync API**: Service Workerを定期的に（例えば数時間おきに）バックグラウンドで起動させるためのAPIです。このAPIを利用して定期的にService Workerを起動し、次の通知時刻が近いかを確認してタイマーを再設定することで、`setTimeout`の信頼性を向上させることができます。ただし、このAPIはまだ一部のブラウザでしかサポートされていません。

今回の実装は、**サーバーレスで手軽に導入できる**ことを優先した結果の選択となります。将来的に通知の信頼性がより重要になる場合は、Web Push APIへの移行を検討する必要があります。
